@page "/"
@using Nethereum.JsonRpc.Client.RpcMessages
@using Nethereum.Metamask
@using Nethereum.Metamask.Blazor
@using Nethereum.RPC.HostWallet
@using System.Numerics

<PageTitle>Home</PageTitle>

<h1>Hello, world!</h1>

Welcome to your new app.

<MudButton OnClick="Change">Change</MudButton>

@code {

    [Inject] public MetamaskHostProvider HostProvider { get; set; }
    [Inject] public IJSRuntime JsRuntime { get; set; }

    private async Task Change()
    {
        var web3 = await HostProvider.GetWeb3Async();
        var chainId = new BigInteger(462);

        AddEthereumChainParameter addEthereumChainParameter = new()
            {
                ChainId = new Nethereum.Hex.HexTypes.HexBigInteger(chainId),
                ChainName = "Areon Network Testnet",
                BlockExplorerUrls = ["https://areonscan.com/"],
                RpcUrls = ["https://testnet-rpc.areon.network"],
                NativeCurrency = new NativeCurrency()
                {
                    Decimals = 18,
                    Name = "TAREA",
                    Symbol = "TAREA"
                }

            };
        var account = await HostProvider.GetProviderSelectedAccountAsync();
        var request = web3.Eth.HostWallet.AddEthereumChain.BuildRequest(addEthereumChainParameter);
        MetamaskBlazorInterop MMInterop = new(JsRuntime);
        await MMInterop.SendAsync(new MetamaskRpcRequestMessage(Guid.NewGuid().ToString(), request.Method, account, request.RawParameters));

    }
}